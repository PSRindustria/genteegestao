<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Banco de Talentos Inteligente - PSR</title>
    <meta name="robots" content="noindex, nofollow">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üß†</text></svg>">
    
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <style>
        :root {
            --psr-blue: #003366;
            --psr-accent: #00c2ff;
            --bg-gray: #f0f2f5;
            --white: #ffffff;
            --text: #333;
            --border: #e0e0e0;
            --success: #28a745;
            --danger: #dc3545;
        }

        * { box-sizing: border-box; outline: none; }
        body { font-family: 'Poppins', sans-serif; background-color: var(--bg-gray); margin: 0; color: var(--text); padding-bottom: 50px; }

        /* --- LOGIN & LOAD --- */
        .full-screen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; flex-direction: column; z-index: 999; }
        #login-screen { background: linear-gradient(135deg, var(--psr-blue) 0%, #001a33 100%); color: white; }
        #loading-screen { background: rgba(255,255,255,0.95); z-index: 1000; }
        #access-denied { background: #fee2e2; color: #991b1b; display: none; }
        #app-screen { display: none; }

        .auth-card { background: white; padding: 40px; border-radius: 12px; box-shadow: 0 20px 50px rgba(0,0,0,0.3); text-align: center; width: 350px; color: #333; }
        .btn-google { width: 100%; padding: 12px; border: 1px solid #ccc; background: white; border-radius: 8px; font-weight: 600; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 10px; margin-top: 20px; transition: 0.3s; }
        .btn-google:hover { background: #f8f9fa; }

        /* --- LAYOUT --- */
        header { background: var(--psr-blue); color: white; padding: 15px 30px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .logo h1 { margin: 0; font-size: 1.2rem; }
        .logo span { font-size: 0.8rem; opacity: 0.8; }
        
        .main-container { max-width: 1400px; margin: 20px auto; padding: 0 20px; display: grid; grid-template-columns: 300px 1fr; gap: 20px; }

        /* --- SIDEBAR FILTROS --- */
        .sidebar { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); height: fit-content; position: sticky; top: 20px; }
        .sidebar h3 { margin-top: 0; color: var(--psr-blue); font-size: 1rem; border-bottom: 2px solid var(--bg-gray); padding-bottom: 10px; display: flex; align-items: center; gap: 8px; }
        
        .filter-group { margin-bottom: 15px; }
        .filter-group label { display: block; font-size: 0.8rem; font-weight: 600; color: #666; margin-bottom: 5px; }
        .filter-input { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-family: inherit; font-size: 0.9rem; transition: 0.3s; }
        .filter-input:focus { border-color: var(--psr-blue); box-shadow: 0 0 0 3px rgba(0, 51, 102, 0.1); }
        
        .geo-group { background: #e3f2fd; padding: 10px; border-radius: 8px; border: 1px solid #bbdefb; }
        .geo-group label { color: #0d47a1; }

        .btn-filter { width: 100%; padding: 10px; background: var(--psr-blue); color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; margin-top: 10px; transition: 0.2s; }
        .btn-filter:hover { background: #002244; }
        .btn-clear { background: #e0e0e0; color: #333; margin-top: 10px; }
        .btn-clear:hover { background: #d0d0d0; }

        /* --- MAIN CONTENT --- */
        .top-bar { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; background: white; padding: 15px; border-radius: 10px; }
        .stats { font-size: 0.9rem; color: #666; }
        .stats strong { color: var(--psr-blue); font-size: 1.1rem; }

        .btn-add { background: var(--success); color: white; padding: 10px 20px; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; display: flex; align-items: center; gap: 8px; }
        .btn-add:hover { background: #218838; }

        /* --- TABLE --- */
        .table-container { background: white; border-radius: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); overflow-x: auto; min-height: 400px; }
        table { width: 100%; border-collapse: collapse; min-width: 900px; }
        th { background: #f8f9fa; text-align: left; padding: 15px; font-size: 0.8rem; text-transform: uppercase; color: #666; border-bottom: 2px solid #eee; position: sticky; top: 0; z-index: 10; }
        td { padding: 15px; border-bottom: 1px solid #eee; font-size: 0.9rem; vertical-align: middle; }
        tr:hover { background: #f0f7ff; }

        .badge { padding: 4px 8px; border-radius: 4px; font-size: 0.75rem; font-weight: 600; text-transform: uppercase; }
        .badge-area { background: #e3f2fd; color: #0d47a1; }
        .badge-prod { background: #e8f5e9; color: #1b5e20; }
        .badge-adm { background: #fff3e0; color: #e65100; }
        .dist-badge { background: #f3e5f5; color: #7b1fa2; font-size: 0.7rem; margin-left: 5px; padding: 2px 5px; border-radius: 3px; }

        .actions-cell { display: flex; gap: 10px; }
        .btn-icon { background: none; border: none; cursor: pointer; font-size: 1.1rem; color: #999; transition: 0.2s; }
        .btn-icon:hover { color: var(--psr-blue); transform: scale(1.1); }
        .btn-icon.delete:hover { color: var(--danger); }

        /* --- MODAL --- */
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 2000; display: none; align-items: center; justify-content: center; backdrop-filter: blur(2px); }
        .modal-box { background: white; width: 90%; max-width: 800px; border-radius: 12px; padding: 30px; max-height: 90vh; overflow-y: auto; box-shadow: 0 10px 30px rgba(0,0,0,0.3); }
        .modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; border-bottom: 1px solid #eee; padding-bottom: 10px; }
        .modal-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .full-width { grid-column: span 2; }
        
        .form-group label { display: block; font-size: 0.8rem; font-weight: 600; margin-bottom: 5px; color: #555; }
        .form-group input, .form-group select, .form-group textarea { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-family: inherit; }
        
        @media (max-width: 768px) {
            .main-container { grid-template-columns: 1fr; }
            .sidebar { position: static; margin-bottom: 20px; }
            .modal-grid { grid-template-columns: 1fr; }
            .full-width { grid-column: span 1; }
        }
    </style>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, signInWithPopup, GoogleAuthProvider, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { getDatabase, ref, set, get, child, update, push, remove } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        // Configura√ß√£o do Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyD4lN6iyKpdstb99vosxEDDaEn1QFXLCXI",
            authDomain: "agenda-portal-2d149.firebaseapp.com",
            databaseURL: "https://agenda-portal-2d149-default-rtdb.firebaseio.com",
            projectId: "agenda-portal-2d149",
            storageBucket: "agenda-portal-2d149.firebasestorage.app",
            messagingSenderId: "172797946066",
            appId: "1:172797946066:web:b3f50853717477661c650b"
        };

        const ALLOWED_EMAILS = [
            'marketingpsrimpressao@gmail.com',
            'rohsantos1@gmail.com',
            'thaisportoaraujo6@gmail.com',
            'milenessfranca@gmail.com'
        ];

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getDatabase(app);
        const provider = new GoogleAuthProvider();

        let allCandidates = [];
        let currentEditId = null;

        // --- MAPA DE COORDENADAS (ATLAS LOCAL) ---
        // Adicionei coordenadas fixas para tornar a busca INSTANT√ÇNEA na regi√£o
        const CITY_COORDS = {
            "paracambi": {lat: -22.6111, lon: -43.7125},
            "japeri": {lat: -22.6436, lon: -43.6542},
            "mendes": {lat: -22.5261, lon: -43.7328},
            "engenheiro paulo de frontin": {lat: -22.5511, lon: -43.6789},
            "seropedica": {lat: -22.7444, lon: -43.7086},
            "pira√≠": {lat: -22.6288, lon: -43.8983},
            "barra do pira√≠": {lat: -22.4697, lon: -43.8247},
            "vassouras": {lat: -22.4045, lon: -43.6631},
            "miguel pereira": {lat: -22.4578, lon: -43.4800},
            "paty do alferes": {lat: -22.4300, lon: -43.4242},
            "nova igua√ßu": {lat: -22.7561, lon: -43.4607},
            "queimados": {lat: -22.7153, lon: -43.5558},
            "rio de janeiro": {lat: -22.9068, lon: -43.1729},
            "volta redonda": {lat: -22.5231, lon: -44.1042},
            "itagua√≠": {lat: -22.8696, lon: -43.7758}
        };

        // --- AUTH ---
        onAuthStateChanged(auth, (user) => {
            document.getElementById('loading-screen').style.display = 'none';
            if (user && ALLOWED_EMAILS.includes(user.email.toLowerCase())) {
                document.getElementById('user-email').innerText = user.email;
                document.getElementById('login-screen').style.display = 'none';
                document.getElementById('app-screen').style.display = 'block';
                carregarCandidatos();
            } else if (user) {
                document.getElementById('denied-email').innerText = user.email;
                document.getElementById('access-denied').style.display = 'flex';
                document.getElementById('login-screen').style.display = 'none';
            } else {
                document.getElementById('login-screen').style.display = 'flex';
            }
        });

        window.login = () => signInWithPopup(auth, provider);
        window.logout = () => signOut(auth).then(() => location.reload());

        // --- CRUD CANDIDATOS ---
        async function carregarCandidatos() {
            const tableBody = document.getElementById('table-body');
            tableBody.innerHTML = '<tr><td colspan="6" style="text-align:center; padding:20px;">Sincronizando Banco de Talentos...</td></tr>';
            
            try {
                const snapshot = await get(child(ref(db), 'candidatos'));
                allCandidates = [];
                if (snapshot.exists()) {
                    snapshot.forEach(childSnapshot => {
                        allCandidates.push({
                            id: childSnapshot.key,
                            ...childSnapshot.val()
                        });
                    });
                }
                aplicarFiltros();
            } catch (error) {
                console.error(error);
                alert("Erro ao carregar: " + error.message);
            }
        }

        window.salvarCandidato = async () => {
            // (Mesma l√≥gica de antes, mantida)
            const data = {
                nome: document.getElementById('c_nome').value,
                email: document.getElementById('c_email').value,
                nascimento: document.getElementById('c_nascimento').value,
                cpf: document.getElementById('c_cpf').value,
                telefone: document.getElementById('c_telefone').value,
                whatsapp: document.getElementById('c_whatsapp').value,
                sexo: document.getElementById('c_sexo').value,
                estado_civil: document.getElementById('c_civil').value,
                area: document.getElementById('c_area').value,
                cep: document.getElementById('c_cep').value,
                endereco: document.getElementById('c_endereco').value,
                bairro: document.getElementById('c_bairro').value,
                cidade: document.getElementById('c_cidade').value,
                link_curriculo: document.getElementById('c_link').value,
                data_cadastro: currentEditId ? (allCandidates.find(c => c.id === currentEditId).data_cadastro) : new Date().toISOString()
            };

            if (!data.nome || !data.area) return alert("Nome e √Årea s√£o obrigat√≥rios!");

            try {
                if (currentEditId) {
                    await update(ref(db, `candidatos/${currentEditId}`), data);
                    alert("Atualizado com sucesso!");
                } else {
                    await push(ref(db, 'candidatos'), data);
                    alert("Cadastrado com sucesso!");
                }
                closeModal();
                carregarCandidatos();
            } catch (e) {
                alert("Erro ao salvar: " + e.message);
            }
        };

        window.deletarCandidato = async (id) => {
            if (confirm("Excluir permanentemente?")) {
                await remove(ref(db, `candidatos/${id}`));
                carregarCandidatos();
            }
        };

        window.editarCandidato = (id) => {
            const c = allCandidates.find(x => x.id === id);
            if (!c) return;
            currentEditId = id;
            document.getElementById('modalTitle').innerText = "Editar Candidato";
            const fields = ['nome', 'email', 'nascimento', 'cpf', 'telefone', 'whatsapp', 'sexo', 'civil', 'area', 'cep', 'endereco', 'bairro', 'cidade', 'link'];
            fields.forEach(f => {
                const key = f === 'civil' ? 'estado_civil' : (f === 'link' ? 'link_curriculo' : f);
                document.getElementById(`c_${f}`).value = c[key] || '';
            });
            openModal();
        };

        // --- FILTROS INTELIGENTES ---

        // 1. Fun√ß√£o Levenshtein (Para tolerar erros de digita√ß√£o)
        function levenshtein(a, b) {
            const matrix = [];
            for (let i = 0; i <= b.length; i++) matrix[i] = [i];
            for (let j = 0; j <= a.length; j++) matrix[0][j] = j;
            for (let i = 1; i <= b.length; i++) {
                for (let j = 1; j <= a.length; j++) {
                    if (b.charAt(i - 1) == a.charAt(j - 1)) {
                        matrix[i][j] = matrix[i - 1][j - 1];
                    } else {
                        matrix[i][j] = Math.min(matrix[i - 1][j - 1] + 1, Math.min(matrix[i][j - 1] + 1, matrix[i - 1][j] + 1));
                    }
                }
            }
            return matrix[b.length][a.length];
        }

        // Verifica se texto A parece com texto B (Fuzzy Match)
        function isFuzzyMatch(textoInput, textoBanco) {
            if (!textoInput) return true;
            if (!textoBanco) return false;
            
            const a = textoInput.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g, "").trim();
            const b = textoBanco.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g, "").trim();

            if (b.includes(a)) return true; // Match exato parcial

            // Toler√¢ncia: Permite 1 erro a cada 4 caracteres (ex: 2 erros numa palavra de 8 letras)
            const maxErrors = Math.floor(a.length / 4) + 1; 
            const dist = levenshtein(a, b);
            return dist <= maxErrors; 
        }

        // 2. C√°lculo de Dist√¢ncia (Haversine)
        function getDistanceFromLatLonInKm(lat1, lon1, lat2, lon2) {
            var R = 6371; // Raio da Terra em km
            var dLat = deg2rad(lat2 - lat1);
            var dLon = deg2rad(lon2 - lon1);
            var a = Math.sin(dLat / 2) * Math.sin(dLat / 2) +
                    Math.cos(deg2rad(lat1)) * Math.cos(deg2rad(lat2)) *
                    Math.sin(dLon / 2) * Math.sin(dLon / 2);
            var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
            var d = R * c; 
            return d;
        }

        function deg2rad(deg) { return deg * (Math.PI / 180); }

        window.aplicarFiltros = () => {
            const btnFilter = document.querySelector('.btn-filter');
            btnFilter.innerText = "Processando...";
            
            setTimeout(() => { // Timeout para n√£o travar a UI enquanto calcula
                const fNome = document.getElementById('f_nome').value;
                const fArea = document.getElementById('f_area').value;
                const fCidade = document.getElementById('f_cidade').value;
                const fBairro = document.getElementById('f_bairro').value; // Novo filtro Bairro
                
                // Filtros Geo
                const fGeoRef = document.getElementById('f_geo_ref').value.toLowerCase().trim();
                const fGeoRaio = parseFloat(document.getElementById('f_geo_km').value) || 0;

                let coordsRef = null;
                if (fGeoRef && CITY_COORDS[fGeoRef]) {
                    coordsRef = CITY_COORDS[fGeoRef];
                }

                const filtered = allCandidates.filter(c => {
                    // Match Inteligente (Fuzzy)
                    const matchNome = isFuzzyMatch(fNome, c.nome);
                    const matchArea = fArea === "" || c.area === fArea;
                    const matchCidade = isFuzzyMatch(fCidade, c.cidade);
                    const matchBairro = isFuzzyMatch(fBairro, c.bairro);

                    // Match Geogr√°fico
                    let matchGeo = true;
                    let distText = "";
                    
                    if (fGeoRaio > 0 && fGeoRef) {
                        const candCityNorm = (c.cidade || "").toLowerCase().trim();
                        // Se temos coordenadas da cidade do candidato
                        if (candCityNorm && CITY_COORDS[candCityNorm] && coordsRef) {
                            const coordsCand = CITY_COORDS[candCityNorm];
                            const dist = getDistanceFromLatLonInKm(coordsRef.lat, coordsRef.lon, coordsCand.lat, coordsCand.lon);
                            
                            c.distanciaCalculada = dist.toFixed(1); // Salva para exibir na tabela
                            if (dist > fGeoRaio) matchGeo = false;
                        } else if (fGeoRef !== candCityNorm) {
                            // Se n√£o conhecemos a cidade e ela n√£o √© a cidade refer√™ncia, 
                            // por seguran√ßa, ocultamos (ou mostramos se quiser ser permissivo)
                            // Aqui vamos ocultar para ser preciso
                            matchGeo = false;
                            
                            // Exce√ß√£o: Se for a MESMA cidade digitada (ex: Paracambi = Paracambi), a dist√¢ncia √© 0
                            if (isFuzzyMatch(fGeoRef, candCityNorm)) matchGeo = true;
                        }
                    } else {
                        c.distanciaCalculada = null;
                    }

                    return matchNome && matchArea && matchCidade && matchBairro && matchGeo;
                });

                renderTable(filtered);
                btnFilter.innerText = "Aplicar Filtros";
            }, 50);
        };

        function renderTable(list) {
            const tbody = document.getElementById('table-body');
            document.getElementById('total-count').innerText = list.length;
            tbody.innerHTML = "";

            if (list.length === 0) {
                tbody.innerHTML = '<tr><td colspan="6" style="text-align:center; padding:30px; color:#888;">Nenhum candidato encontrado.</td></tr>';
                return;
            }

            list.forEach(c => {
                let idade = 'N/D';
                if(c.nascimento) {
                    const birth = new Date(c.nascimento);
                    if(!isNaN(birth)) idade = (new Date().getFullYear() - birth.getFullYear()) + ' anos';
                }
                
                let badgeClass = 'badge-area';
                if (c.area === 'Produ√ß√£o') badgeClass = 'badge-prod';
                if (['Administrativo','Financeiro','RH'].includes(c.area)) badgeClass = 'badge-adm';

                let btnLink = `<span style="color:#eee; cursor:default"><i class="fas fa-link"></i></span>`;
                if (c.link_curriculo && c.link_curriculo.length > 5) {
                    btnLink = `<a href="${c.link_curriculo}" target="_blank" class="btn-icon" style="color:#0078d4" title="Abrir Curr√≠culo"><i class="fas fa-cloud"></i></a>`;
                }

                const wpp = c.whatsapp ? c.whatsapp.replace(/\D/g, '') : '';
                const btnWpp = wpp ? `<a href="https://wa.me/55${wpp}" target="_blank" class="btn-icon" style="color:#25d366"><i class="fab fa-whatsapp"></i></a>` : `<span class="btn-icon" style="color:#eee"><i class="fab fa-whatsapp"></i></span>`;

                // Exibi√ß√£o da Dist√¢ncia (se houver filtro Geo ativo)
                let localHtml = `${c.cidade || '-'} / ${c.bairro || '-'}`;
                if (c.distanciaCalculada) {
                    localHtml += `<span class="dist-badge"><i class="fas fa-map-marker-alt"></i> ${c.distanciaCalculada}km</span>`;
                }

                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>
                        <div style="font-weight:600; color:var(--psr-blue)">${c.nome}</div>
                        <div style="font-size:0.75rem; color:#888">${c.email || ''}</div>
                    </td>
                    <td><span class="badge ${badgeClass}">${c.area}</span></td>
                    <td>${idade}</td>
                    <td>${localHtml}</td>
                    <td>${c.telefone || '-'}</td>
                    <td class="actions-cell">
                        ${btnWpp}
                        ${btnLink}
                        <button onclick="editarCandidato('${c.id}')" class="btn-icon" title="Editar"><i class="fas fa-edit"></i></button>
                        <button onclick="deletarCandidato('${c.id}')" class="btn-icon delete" title="Excluir"><i class="fas fa-trash"></i></button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        // --- UI ---
        window.openModal = () => document.getElementById('modalCandidato').style.display = 'flex';
        window.closeModal = () => {
            document.getElementById('modalCandidato').style.display = 'none';
            currentEditId = null;
            document.getElementById('formCandidato').reset();
            document.getElementById('modalTitle').innerText = "Novo Candidato";
        }
        window.limparFiltros = () => {
            document.querySelectorAll('.filter-input').forEach(el => el.value = '');
            aplicarFiltros();
        }

    </script>
</head>
<body>

    <div id="loading-screen" class="full-screen">
        <i class="fas fa-spinner fa-spin fa-3x" style="color:var(--psr-blue)"></i>
        <p style="margin-top:15px">Carregando Intelig√™ncia...</p>
    </div>

    <div id="login-screen" class="full-screen">
        <div class="auth-card">
            <h2>PSR Talentos</h2>
            <p>Acesso Restrito Inteligente</p>
            <button onclick="login()" class="btn-google">
                <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" width="20"> Entrar com Google
            </button>
        </div>
    </div>

    <div id="access-denied" class="full-screen">
        <div class="auth-card" style="border-top: 5px solid red;">
            <h2 style="color:red">Acesso Negado</h2>
            <p>O e-mail <b id="denied-email"></b> n√£o tem permiss√£o.</p>
            <button onclick="logout()" class="btn-google" style="border:1px solid red; color:red">Sair</button>
        </div>
    </div>

    <div id="app-screen">
        <header>
            <div class="logo">
                <h1>Banco de Talentos <i class="fas fa-brain" style="color:var(--psr-accent); font-size:0.9rem"></i></h1>
                <span>PSR Impress√£o</span>
            </div>
            <div style="display:flex; align-items:center; gap:15px">
                <span id="user-email" style="font-size:0.8rem">...</span>
                <button onclick="logout()" style="background:none; border:none; color:white; cursor:pointer"><i class="fas fa-sign-out-alt"></i> Sair</button>
            </div>
        </header>

        <div class="main-container">
            <aside class="sidebar">
                <h3><i class="fas fa-filter"></i> Filtros Inteligentes</h3>
                
                <div class="filter-group">
                    <label>Nome (Aceita erros)</label>
                    <input type="text" id="f_nome" class="filter-input" placeholder="Ex: Joa da Silva">
                </div>

                <div class="filter-group">
                    <label>√Årea</label>
                    <select id="f_area" class="filter-input">
                        <option value="">Todas</option>
                        <option value="Produ√ß√£o">Produ√ß√£o</option>
                        <option value="Financeiro">Financeiro</option>
                        <option value="RH">RH</option>
                        <option value="Administra√ß√£o">Administra√ß√£o</option>
                        <option value="Comercial">Comercial</option>
                        <option value="Log√≠stica">Log√≠stica</option>
                    </select>
                </div>

                <div class="filter-group geo-group">
                    <label><i class="fas fa-map-marked-alt"></i> Busca nas Proximidades</label>
                    <input type="text" id="f_geo_ref" class="filter-input" placeholder="Refer√™ncia (Ex: Paracambi)" style="margin-bottom:5px">
                    <div style="display:flex; align-items:center; gap:5px">
                        <input type="number" id="f_geo_km" class="filter-input" placeholder="Raio (km)">
                        <span style="font-size:0.8rem; color:#666">km</span>
                    </div>
                </div>

                <div class="filter-group">
                    <label>Cidade (Texto Livre)</label>
                    <input type="text" id="f_cidade" class="filter-input" placeholder="Ex: Nova Iguacu">
                </div>

                <div class="filter-group">
                    <label>Bairro</label>
                    <input type="text" id="f_bairro" class="filter-input" placeholder="Ex: Centro">
                </div>

                <button class="btn-filter" onclick="aplicarFiltros()">Aplicar Filtros</button>
                <button class="btn-filter btn-clear" onclick="limparFiltros()">Limpar</button>
            </aside>

            <main>
                <div class="top-bar">
                    <div class="stats">
                        Candidatos Vis√≠veis: <strong id="total-count">0</strong>
                    </div>
                    <button class="btn-add" onclick="openModal()"><i class="fas fa-plus"></i> Novo Candidato</button>
                </div>

                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Candidato</th>
                                <th>√Årea</th>
                                <th>Idade</th>
                                <th>Localiza√ß√£o</th>
                                <th>Telefone</th>
                                <th>A√ß√µes</th>
                            </tr>
                        </thead>
                        <tbody id="table-body">
                            </tbody>
                    </table>
                </div>
            </main>
        </div>
    </div>

    <div id="modalCandidato" class="modal-overlay">
        <div class="modal-box">
            <div class="modal-header">
                <h3 id="modalTitle" style="color:var(--psr-blue); margin:0">Novo Candidato</h3>
                <button onclick="closeModal()" style="border:none; background:none; cursor:pointer; font-size:1.2rem">&times;</button>
            </div>
            
            <form id="formCandidato" onsubmit="event.preventDefault(); salvarCandidato();">
                <div class="modal-grid">
                    <div class="form-group full-width">
                        <label>Nome Completo *</label>
                        <input type="text" id="c_nome" required>
                    </div>
                    
                    <div class="form-group">
                        <label>Email</label>
                        <input type="email" id="c_email">
                    </div>
                    <div class="form-group">
                        <label>Data Nascimento</label>
                        <input type="date" id="c_nascimento">
                    </div>

                    <div class="form-group">
                        <label>CPF</label>
                        <input type="text" id="c_cpf">
                    </div>
                    <div class="form-group">
                        <label>Telefone</label>
                        <input type="text" id="c_telefone">
                    </div>
                    
                    <div class="form-group">
                        <label>WhatsApp</label>
                        <input type="text" id="c_whatsapp">
                    </div>
                    <div class="form-group">
                        <label>√Årea Pretendida *</label>
                        <select id="c_area" required>
                            <option value="">Selecione...</option>
                            <option value="Produ√ß√£o">Produ√ß√£o</option>
                            <option value="Financeiro">Financeiro</option>
                            <option value="RH">RH</option>
                            <option value="Administra√ß√£o">Administra√ß√£o</option>
                            <option value="Comercial">Comercial</option>
                            <option value="Log√≠stica">Log√≠stica</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>Sexo</label>
                        <select id="c_sexo">
                            <option value="">Selecione...</option>
                            <option value="Masculino">Masculino</option>
                            <option value="Feminino">Feminino</option>
                            <option value="Outro">Outro</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Estado Civil</label>
                        <input type="text" id="c_civil">
                    </div>

                    <div class="form-group full-width">
                        <label>Link do Curr√≠culo</label>
                        <input type="url" id="c_link" placeholder="https://onedrive.live.com/...">
                    </div>

                    <div class="form-group">
                        <label>CEP</label>
                        <input type="text" id="c_cep">
                    </div>
                    <div class="form-group">
                        <label>Endere√ßo</label>
                        <input type="text" id="c_endereco">
                    </div>
                    <div class="form-group">
                        <label>Bairro</label>
                        <input type="text" id="c_bairro">
                    </div>
                    <div class="form-group">
                        <label>Cidade</label>
                        <input type="text" id="c_cidade">
                    </div>
                </div>

                <div style="margin-top:20px; display:flex; gap:10px; justify-content:flex-end">
                    <button type="button" onclick="closeModal()" style="padding:10px 20px; border:none; background:#eee; cursor:pointer; border-radius:6px">Cancelar</button>
                    <button type="submit" style="padding:10px 20px; border:none; background:var(--psr-blue); color:white; cursor:pointer; border-radius:6px">Salvar</button>
                </div>
            </form>
        </div>
    </div>

</body>
</html>
